{% extends 'layouts/two_pane.html' %}

{% load custom_tags %}

{% block back-button %}
	<a href="{{ page.back_link.url }}" class="govuk-back-link">{{ page.back_link.text }}</a>
{% endblock %}

{% block twoThirds %}

	<!-- Error Summary -->
	{% if errors %}
		<div class="govuk-error-summary" aria-labelledby="error-summary-title" role="alert" tabindex="-1" data-module="error-summary">
			<h2 class="govuk-error-summary__title" id="error-summary-title">
				There are errors on this page
			</h2>
			<div class="govuk-error-summary__body">
				<ul class="govuk-list govuk-error-summary__list">
					{% for key, value in errors.items %}
						<li>
							<a href="#{{ key }}">
								{% for error in value %}
									{{ error }}
								{% endfor %}
							</a>
						</li>
					{% endfor %}
				</ul>
			</div>
		</div>
	{% endif %}

	<!-- Page header and description -->
	{% if page.caption %}
		<span class="govuk-caption-l">{{ page.caption }}</span>
	{% endif %}
		<h1 class="govuk-heading-l">{{ page.title }}</h1>
		<div class="govuk-form-group">
			<p class="govuk-caption-m">
				{{ page.description }}
			</p>
		</div>

		<!-- Questions -->
		<form method="post">
			{% csrf_token %}

			{% for question in page.questions %}
				{% if question.input_type.name == "HTML"  %}
					{{ question.html|safe }}
				{% elif question.input_type.name == "DETAIL"  %}
					{% include "components/details.html" with title=question.title description=question.description %}
				{% elif question.input_type.name == "HEADING" %}
					<br/>
					<h{{ question.heading_style.value }} class="govuk-heading-{{ question.heading_style.name|lower }}">{{ question.text }}</h{{ question.heading_style.value }}>
				{% else %}
					{% if question.input_type == "side_by_side" %}
						<div class="lite-side-by-side-wrapper">
							{% for question in question.questions %}
								{% include "components.html" with question=question errors=errors %}
							{% endfor %}
						</div>
					{% else %}
						{% include "components.html" with question=question errors=errors %}
					{% endif %}
			{% endif %}
		{% endfor %}

		<!-- Buttons -->
		<div class="govuk-form-group">
			<div class="buttons-row">
				{% for button in page.buttons %}
					<button type="submit" class="{{ button.style.value }}" action="submit">{{ button.value }}</button>
				{% endfor %}
			</div>
		</div>
	</form>

	<script type="text/javascript">
		function showHidePanels() {
			$('input:radio').each(function () {
				var $this = $(this)
				var show_pane = $this.attr('show_pane')
				$('#' + show_pane).addClass('govuk-inset-text')

				if (show_pane) {
					if ($this.is(':checked')) {
						$('#' + show_pane).show()
					} else {
						$('#' + show_pane).hide()
					}
				}
			});
		}

		showHidePanels()

		$("input:radio").on("change", function() {
			showHidePanels()
		});
	</script>

{% endblock %}
{% block oneThird %}
	{% for question in page.helpers %}
		<aside class="lite-related-items" role="complementary">
			<h2 class="govuk-heading-m" id="subsection-title">
				{{ question.title }}
			</h2>
			<p class="govuk-body">
				{{ question.description }}
			</p>
		</aside>
	{% endfor %}

	{% for url in page.javascript_imports %}
		<script src="{{ url }}"></script>
	{% endfor %}
{% endblock %}
