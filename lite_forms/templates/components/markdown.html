<div data-module="character-count" data-maxlength="{{ extras.max_length }}">
	<textarea class="govuk-textarea js-character-count {% if error %}govuk-textarea--error{% endif %}"
		  id="{{ name }}"
		  name="{{ name }}"
		  rows="10"
		  cols="40"
          {% if extras.max_length %}
              maxlength="{{ extras.max_length }}"
          {% endif %}>{{ value }}</textarea>
	{% if extras.max_length %}
		<span id="{{ name }}-info" class="govuk-hint govuk-character-count__message" aria-live="polite" style="margin-top: -10px;">
			You can enter up to {{ extras.max_length }} characters
		</span>
	{% endif %}
</div>

{% load static %}

{% block javascript %}
<link rel="stylesheet" type="text/css" href="{% static 'css/jquery.atwho.css' %}">
<script type="text/javascript" src="https://code.jquery.com/jquery-2.2.0.min.js"></script>
<script type="text/javascript" src="https://ichord.github.io/Caret.js/src/jquery.caret.js"></script>
<script type="text/javascript" src="{% static 'javascripts/jquery.atwho.js' %}"></script>
<script type="text/javascript">
  $(function(){
    var data = {{ variables|safe }};
    var id = '#{{ name }}';

    var at_config = {
      at: "{% templatetag openvariable %}",
      data: data,
      headerTpl: '<div class="atwho-header govuk-label">Variables</div>',
      insertTpl: '{% templatetag openvariable %} ${key} {% templatetag closevariable %}',
      displayTpl: "<li class='govuk-label'>${key} <small>${value}</small></li>"
    };
    $inputor = $(id).atwho(at_config);
    $inputor.caret('pos', 47);
    $inputor.focus().atwho('run');

    $('#editable').atwho(at_config);
  });
  </script>
{% endblock %}
